# 5. Java: Sentiment Analysis with CoreNLP

## Особенности реализации

Так как отзывы в датасете содержат HTML-разметку, перед анализом необходимо очистить текст:
```java
String cleaned = text.replaceAll("<br\\s*/?>", " ").trim();
```

Преобразование тональности, приводим шкалу к 3 категориям:
```java
private String mapToSimple(String s) {
    if (s == null) return "neutral";
    s = s.toLowerCase();
    if (s.contains("positive")) {
        return "positive";
    } else if (s.contains("negative")) {
        return "negative";
    } else {
        return "neutral";
    }
}
```

## Основные файлы

### App.java 

Это точка входа в программу, которая координирует весь процесс анализа. Основные методы:
- main(String[] args) - запускает процесс анализа;
- getGreeting() - возвращает приветственное сообщение (требуется для тестов).

### SentimentUtils.java

Класс для анализа тональности, содержит всю логику работы со Stanford CoreNLP и обработки данных.

Вложенный класс Review:
```java
public static class Review {
    public final String text;    // Текст отзыва
    public final String label;   // Фактическая тональность (positive/negative)
    
    public Review(String text, String label) {
        this.text = text;
        this.label = label;
    }
}
```

Основные методы:
1. Конструктор SentimentUtils() - инициализирует Stanford CoreNLP pipeline и настраивает аннотаторы: tokenize, ssplit, parse, sentiment;
2. analyzeSentiment(String text) — анализ тональности текста;
3. mapToSimple(String s) — преобразование тональности;
4. loadReviews(String path) — загрузка данных из CSV;

### AppTest.java

Проверяет базовую функциональность приложения:
- Наличие приветственного сообщения;
- Корректное создание анализатора;
- Работу класса Review;

## Работа системы

Система начинает работу с загрузки датасета IMDB, содержащего 50000 отзывов о фильмах. Для каждого текста выполняется следующий процесс:
1. Токенизация: текст разбивается на отдельные слова;
2. Сегментация на предложения: текст разделяется на предложения;
3. Синтаксический анализ: строится дерево зависимостей;
4. Анализ тональности: для каждого предложения определяется эмоциональная окраска;
5. Агрегация результатов: тональности всех предложений объединяются.

Для оценки качества работы системы выбирается случайная выборка из 15 отзывов. Для каждого отзыва получается предсказание от Stanford CoreNLP, сравнивается с фактической меткой из датасета и рассчитывается общая точность.