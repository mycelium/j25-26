Оптимизация:
инициализация перменной раз для последнего цикла -> отсутствие ненужного повторного обращения
меняем порядок циклов для лучшей локальности данных

среднее ускорение = 5.67