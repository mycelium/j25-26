# Лабораторная работа 8: Классификация изображений с DeepLearning4j (DL4J)

Этот проект реализует Свёрточную Нейронную Сеть (Convolutional Neural Network - CNN) используя библиотеку DeepLearning4j для классификации рукописных цифр из набора данных MNIST.

## Требования

- Java 23 (или совместимый JDK)
- Gradle (обертка включена в проект)
- Интернет-соединение (для загрузки зависимостей и набора данных MNIST)

## Структура проекта

- `app/src/main/java/org/example/App.java`: Основной класс приложения, содержащий реализацию CNN.
- `app/build.gradle.kts`: Конфигурация сборки Gradle.
- `gradle/libs.versions.toml`: Каталог версий зависимостей.

## Как запустить

1.  **Клонируйте репозиторий** (если применимо) или перейдите в корень проекта.
2.  **Запустите приложение** используя Gradle wrapper:

    **На Windows (PowerShell/CMD):**
    ```powershell
    ./gradlew run
    ```

    **На Linux/macOS:**
    ```bash
    ./gradlew run
    ```

    *Примечание: Первый запуск может занять некоторое время для загрузки зависимостей и набора данных MNIST.*

## Возможности

- **Архитектура модели**:
  - Вход: черно-белые изображения 28x28
  - Слой 0: Свёртка (Convolution) (ядро 5x5, шаг 1, 20 фильтров, ReLU)
  - Слой 1: Субдискретизация (Max Pooling) (ядро 2x2, шаг 2)
  - Слой 2: Свёртка (Convolution) (ядро 5x5, шаг 1, 50 фильтров, ReLU)
  - Слой 3: Субдискретизация (Max Pooling) (ядро 2x2, шаг 2)
  - Слой 4: Полносвязный слой (Dense Layer) (500 нейронов, ReLU)
  - Выход: Softmax (10 классов)
- **Обучение**: 1 эпоха на обучающей выборке MNIST.
- **Оценка**: Точность (Accuracy), Precision, Recall, F1 Score на тестовой выборке MNIST.
- **Предсказание**:
  - Демонстрация предсказания на одном примере из тестовой выборки.
  - **Загрузка и классификация пользовательских изображений** (`app/1.png`, `app/8.png`).

## Пользовательские изображения

Для проверки собственных изображений:
1. Поместите файлы изображений (PNG/JPG) в папку `app/`.
2. В настоящее время код настроен на чтение файлов `app/1.png` и `app/8.png`.
3. Изображения автоматически:
   - Масштабируются до 28x28.
   - Преобразуются в оттенки серого.
   - Инвертируются (если фон белый, а цифра черная), чтобы соответствовать формату MNIST (белая цифра на черном фоне).

## Запуск тестов

Для запуска всех тестов выполните:
```bash
.\gradlew.bat test
```

Для просмотра подробного вывода с именами тестов:
```bash
.\gradlew.bat test --rerun-tasks
```

Тесты находятся в `app/src/test/java/org/example/MnistClassifierTest.java` и включают:
- Конфигурация модели (6 тестов) - проверка слоев CNN
- Инициализация модели (4 теста) - создание и вывод модели
- Нормализация пикселей (5 тестов)
- Инверсия пикселей (5 тестов)
- Вычисление среднего (4 теста)
- Проверка необходимости инверсии (3 теста)
- Функция argmax (7 тестов)
- Валидация входных данных (5 тестов)
- Константы (4 теста)
- Обработка ошибок (4 теста)