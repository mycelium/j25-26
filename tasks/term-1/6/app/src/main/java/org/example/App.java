/*
 * This source file was generated by the Gradle 'init' task
 */
package org.example;
import java.util.ArrayList;
import java.util.List;

public class App {
    public String getGreeting() {
        return "Hello World!";
    }

    public static void main(String[] args)
    {
        int k;
        double x,y;

        args = new String[] {"9", "9.0", "9.0"};

        if (args.length == 3)
        {
            try
            {
                k = Integer.parseInt(args[0]);
            }
            catch (NumberFormatException e)
            {
                System.out.println("Error: k must be integer");
                System.exit(1);
                return;
            }

            try
            {
                x = Double.parseDouble(args[1]);
            }
            catch (NumberFormatException e)
            {
                System.out.println("Error: x must be double");
                System.exit(1);
                return;
            }

            try
            {
                y = Double.parseDouble(args[2]);
            }
            catch (NumberFormatException e)
            {
                System.out.println("Error: y must be double");
                System.exit(1);
                return;
            }
        }
        else
        {
            k = 29;
            x = 5.0;
            y = 5.0;
        }

        try
        {
            List<Point> trainingData = setTrainingData();
            KNNClassifier classifier = new KNNClassifier(trainingData, k);
            Point newPoint = new Point(x, y);
            String classResult = classifier.classifyNewPoint(newPoint);

            System.out.printf("Point (%.2f, %.2f) belongs to the class: %s%n",
                    x, y, classResult);

            PlotPainter.createPlot(trainingData, newPoint, "knn_plot.png");
            System.out.println("The plot is saved to a file: knn_plot.png");
        }
        catch (Exception e)
        {
            System.out.println("Error: " + e.getMessage());
        }
    }

    public static List<Point> setTrainingData()
    {
        List<Point> data = new ArrayList<>();

        // Class whose points are in the upper-left corner
        // x from 1 to 4, y from 6 to 9
        for (int i = 0; i < 10; i++)
        {
            double x = 1 + Math.random() * 3;
            double y = 6 + Math.random() * 3;
            data.add(new Point(x,y, "upperLeft"));
        }

        // Class whose points are in the upper-right corner
        // x from 6 to 9, y from 6 to 9
        for (int i = 0; i < 10; i++)
        {
            double x = 6 + Math.random() * 3;
            double y = 6 + Math.random() * 3;
            data.add(new Point(x,y, "upperRight"));
        }

        // Class whose points are in the lower-left corner
        // x from 1 to 4, y from 1 to 4
        for (int i = 0; i < 10; i++)
        {
            double x = 1 + Math.random() * 3;
            double y = 1 + Math.random() * 3;
            data.add(new Point(x,y, "lowerLeft"));
        }

        // Class whose points are in the lower-right corner
        // x from 6 to 9, y from 1 to 4
        for (int i = 0; i < 10; i++)
        {
            double x = 6 + Math.random() * 3;
            double y = 1 + Math.random() * 3;
            data.add(new Point(x,y, "lowerRight"));
        }
        return data;
    }
}
