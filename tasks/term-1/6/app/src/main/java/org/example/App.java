/*
 * This source file was generated by the Gradle 'init' task
 */
package org.example;
import java.util.*;

public class App {
    public String getGreeting() {
        return "Hello World!";
    }

    public static void main(String[] args) {
        List<Point> data = List.of(
                new Point(1, 1, "A"),
                new Point(2, 1.2, "A"),
                new Point(2.2, 2.1, "A"),
                new Point(2.5, 1.7, "A"),
                new Point(2.4, 2.6, "A"),
                new Point(2.1, 1.9, "A"),

                new Point(8, 8, "B"),
                new Point(9, 8.5, "B"),
                new Point(9.3, 9.4, "B"),
                new Point(7.7, 8.6, "B"),
                new Point(9.1, 8.8, "B"),
                new Point(7.9, 9.3, "B"),
                new Point(9.4, 8.2, "B"),

                new Point(3, 6, "C"),
                new Point(3.8, 5.5, "C"),
                new Point(4.5, 6.2, "C"),
                new Point(5, 7, "C"),
                new Point(4.2, 7.3, "C"),
                new Point(3.7, 6.8, "C"),
                new Point(4.8, 5.9, "C"),
                new Point(4.3, 7.2, "C")
        );
        Scanner scanner = new Scanner(System.in);
        System.out.println("Enter point coordinates (allowed range: 0 to 10)");

        double x = readDouble(scanner, "Enter X: ", 0, 10);
        double y = readDouble(scanner, "Enter Y: ", 0, 10);

        double[] newPoint = {x, y};
        KNN knn = new KNN(data, 3);
        String predicted = knn.classify(newPoint);
        System.out.println("New point classified as: " + predicted);
        Point test = new Point(newPoint[0], newPoint[1], predicted);

        Graph.save(
                "graph.png",
                data,
                test,
                predicted
        );
    }

    private static double readDouble(Scanner scanner, String message, double min, double max) {
        while (true) {
            System.out.print(message);
            try {
                double value = Double.parseDouble(scanner.nextLine().trim());
                if (value < min || value > max) {
                    System.out.println("Value must be within [" + min + ", " + max + "]. Try again.");
                    continue;
                }
                return value;

            } catch (Exception e) {
                System.out.println("Invalid input! Please enter a valid number.");
            }
        }
    }
}